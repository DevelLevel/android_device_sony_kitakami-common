allow system_server mm-pp-daemon:unix_stream_socket connectto;
allow system_server pps_socket:sock_file write;

allow system_server self:capability sys_module;

# Access to sensors socket
unix_socket_connect(system_server, sensors, sensors)
unix_socket_send(system_server, sensors, sensors)
allow system_server sensors:unix_stream_socket sendto;
allow system_server sensors_socket:sock_file r_file_perms;
qmux_socket(system_server);

#Allow access to netmgrd socket
netmgr_socket(system_server);

#Rules for system server to talk to peripheral manager
use_per_mgr(system_server);

allow system_server system_app_data_file:dir r_dir_perms;

r_dir_file(system_server, sysfs_addrsetup)

allow system_server ta_data_file:dir search;
allow system_server ta_data_file:file r_file_perms;
allow system_server persist_file:dir rw_file_perms;

allow system_server perfd:unix_stream_socket connectto;
allow system_server socket_device:sock_file write;

allow system_server sensors:unix_stream_socket connectto;
allow system_server sensors_device:chr_file getattr;
allow system_server sensors_socket:sock_file write;

allow system_server unlabeled:file unlink;

allow system_server default_android_service:service_manager find;

